```{r knitsetup, echo=FALSE, results='hide', warning=FALSE, message=FALSE, cache=FALSE}
opts_knit$set(base.dir='./', fig.path='', out.format='md')
opts_chunk$set(prompt=TRUE, comment='', results='markup')
# See yihui.name/knitr/options for more Knitr options.
##### Put other setup R code here


# end setup chunk
```
# Day1 Session 1
Melinda Higgins  
March 10, 2016  
---

## Introduction to Git and Github

For this first part, go to my slide set overview at [http://melindahiggins2000.github.io/web2/teaching/CDCslidesMar2016/#1](http://melindahiggins2000.github.io/web2/teaching/CDCslidesMar2016/#1).

These slides cover the information on:
* GIT [https://git-scm.com/](https://git-scm.com/)
* Github [https://github.com/](https://github.com/)
* Github Desktop Client [https://desktop.github.com/](https://desktop.github.com/)

---

## Files, Code and Data for this workshop

You can download all of the data, code and files for this workshop at my Github repository at [https://github.com/melindahiggins2000/CDCRworkshopCode](https://github.com/melindahiggins2000/CDCRworkshopCode). From here click on "Download ZIP" to download everything to your local computer/storage location. You could also "fork" my repository and then "clone" it to your local computer.

I also built a Github repository for this Gitbook "CDC R Workshop". Here are the relevant links:
* my Github repository for the book [https://github.com/melindahiggins2000/CDCRworkshop](https://github.com/melindahiggins2000/CDCRworkshop)
* the final Gitbook [https://www.gitbook.com/book/melindahiggins2000/cdcrworkshop/details](https://www.gitbook.com/book/melindahiggins2000/cdcrworkshop/details)
* and if you'd like to create your own Gitbook [https://www.gitbook.com/](https://www.gitbook.com/)

---

## Explore RStudio
1. Open/Run RStudio
2. Explore the windows and menus
3. See what your settings are in "Tools"/"Global Options"
   + change your "Appearance" to a font size and theme you like
   + take a look at the other options but leave the defaults for now
4. Create a New File - go to "File"/"New File"/"R Script"
    + This will create a new (blank) window at the top left where you can type in an execute R commands. This is similar to the SAS program window.
    + As you type in commands you can select the command (or commands) you want to execute and click "Run" or go to the end of the line and hit "Cntl-Enter".
    + You can also execute commands in the Console window (lower left) but this is like typing commands in at the command line and harder to enter longer commands and edit as needed.
    + However as you run commands from the R Script window, they are echo'd in the Console window. And output is also shown in the console window as appropriate.
    
## Begin writing code in your new script window.

Now that you have your R Script window open, go ahead and save it somewhere on your computer/local storage location (e.g. flash drive, cloud or network drive). Click "File"/"Save As"/ and enter in a name for your file "myfile.r". If you leave off the ".r" extension, it should be added automatically for you. Open your local drive and check to make sure the file saved correctly.

As you enter code, it is always a good idea to add informative comments as you go. The number sign `#` is the delimiter R uses to denote comments. Anything typed after the `#` is echo'd to the screen and not executed. You'll also notice that the R scripting window inside RStudio tries to be helpful by color coding different commands, functions, variables and such so you notice each is handled differently. The comments will be a different color than commands R is trying to execute as code.

Let's try the following code `getwd()` to see what R thinks is your current "home" directory.

```
# ======================================
# see what directory R is currently set to
getwd()

# ======================================
# change your "working directory"
# to a location of your choice
setwd('C:/MyGithub/CDCRworkshopCode')

# ======================================
# check location again
getwd()
```
## Typing in commands - do simple math

Let's type in the following commands and do some math using R. 

You will notice there are 2 ways to enter an exponent: (1) you can use 2 asterix `**` together or (2) you can use the caret `^` symbol.

```{r}
2 + 2
3 + (4*8)
3 + 4*8
6 + (8**2) # exponents can be done using two
           # asterix's ** or you can use
           # the caret ^ symbol
12^2
```

We can also put in named constants like `pi` and have R retrieve the actual stored value (at least to the numerical precision available).

```{r}
pi         # pi is a built in Constant
4 * pi
```

`pi` is a constant built into R. Let's find out what the other constants that are in the base R package? For this we will invoke the `help()` function.

```{r}
help(Constants)

LETTERS
letters
month.abb
month.name
```

## Let's create some data objects and variables with R: numbers and vectors

In the code block below we will create several new data objects in R. As these variables are created notice that the objects are shown and catalogued in the "Global Environment" window (top right).

```{r}
# ====================================
# create x which had 1 numeric value
x <- 3 * 5    # notice nothing is shown in the console
              # you have to type the name of the object 
              # to "see" it
x

# create y which is a numeric (integer) vector
# with 12 elements
y <- 1:12
y

# create z a numeric vector
# containing a sequence of numbers from
# 0 to 10 in units of 0.5
z <- seq(0,10,.5)
z

# the above code can also be done with the
# explict function arguments defined
# see the examples in help(seq)
help(seq)
z <- seq(from=0, to=10, by=0.5)
z

# create new object sinz which is a numeric
# vector now containing the sin (sine function) 
# of the z values
sinz <- sin(z)
```

In addition to reviewing the objects listed in the "Global Environment" window (top right), you can also "list" the objects by running the `ls()` command. You can also get detailed listing using the `ls.str()` command which lists with the object structure details as well. This basically mimics what is provided in the "Global Environment" window. _You can ignore the `bib` object which is created as part of this Gitbook._

```{r}
ls()
ls.str()
```

## Get details on your data objects.

Depending on the data objects you can get additional info from the command line which is helpful especially later on when wanting to know things like the number of variables or columns in a dataset or how many rows meet certain criteria and so on. In the commands below we will explore these commands:
*`length()` - provides the number of elements in a vector
* `str()` - described the structure of a data object
* `class()` - describes the attribute of an object (useful for debugging common errors)
* `dim()` - tells the dimension of a given object (usually a 2D matrix or data frame - gives the number of rows by number of columns)

```{r}
# ========================================
# while you can see information about each of these
# objects in the Global Environment (top right)
# of the RStudio window, the function length()
# is useful for determining how many elements are
# in a given vector/data object.
# ========================================
length(x)
length(y)
length(z)
length(sinz)

# ========================================
# other functions that are helpful for finding
# out about data objects is the str() "structure"
# function and the class() function.
# ========================================
str(y)
class(y)
str(z)
class(z)
```

## Create some more data objects including matrices and data frames

Let's make some different "classes" of vectors and see what happens when we mix different kinds of data inside a vector. We will use the "combine" or `c()` function to create these simple elements.

The first 3 vectors each have elements that are all the same type (or class). But then we'll mix and match the data element types and see what happens.

* a1 is numeric
* a2 is character
* a3 is logical
* a4 is mixed numeric, character and logical
    + so R sets all to the best option so a4 becomes all character type
* a5 is also mixed but only numeric and logical
    + In this case, the logical values are converted to numeric and TRUE becomes 1 and FALSE becomes 0
    
We use the `class()` function to investigate further.
 
```{r}
a1 <- c(1,2,3,4,10,11)
a1
a2 <- c('a','g','f','r','t','s')
a2
a3 <- c(TRUE,FALSE,TRUE,TRUE,FALSE,TRUE)
a3
a4 <- c(1,2,'a','b',TRUE,FALSE)
a4
a5 <- c(1,2,3,4,TRUE,FALSE)
a5

# use the class() function to investigate these further
class(a1)
class(a2)
class(a3)
class(a4)
class(a5)
```

## Combine these vectors into different objects
### 2D Arrays or Matrices

We can use the commands `cbind()` to bind (or combine) vectors together columnwise and `rbind` to bind vectors together by or as rows. However, the resulting data object is a matrix (which is a 2D vector) and like a 1D vector the data elements all have to be of the same type (or class). So notice what happens when we combine these different vectors together (i.e. they all combine into a "character" matrix class).

```{r}
# using cbind()
a1to5cbind <- cbind(a1,a2,a3,a4,a5)
a1to5cbind
class(a1to5cbind)
str(a1to5cbind)
dim(a1to5cbind)

#using rbind()
a1to5rbind <- rbind(a1,a2,a3,a4,a5)
a1to5rbind
class(a1to5rbind)
str(a1to5rbind)
dim(a1to5rbind)
```

### Lists

But what if want to keep the mixture different data element types. Then we need to use a more generic object class like the "list" or "data frame" (which is a special case of a list).

A "list" data object is simply that a list of different objects put together. THe objects can be different types and do not have to be the same length or structure. Let's combine the 5 vectors together. Notice that the `dim()` command does not tell you anything about a generic list. You'll notice that now each vectors data types are preserved.

```{r}
#using list()
a1to5list <- list(a1,a2,a3,a4,a5)
a1to5list
class(a1to5list)
str(a1to5list)
dim(a1to5list)
```

But we could also combine different types of obijects together. Let's combine the number `x`, the 2 vectors `z` and `sinz` and the combined list we just made `a1to5list`.

```{r}
alist1 <- list(x, z, sinz, a1to5list)
alist1
str(alist1)
class(alist1)
```

This may seem haphazard but is actually quite ingenious. The "list" is a great way to carry around a lot of information in 1 complete/compact object. This is the most common way R provides output from functions and statistical procedures and models.

### Data Frames

A special kind of list is the "data frame." A data frame is designed to be rectangular where every column has the same number of rows and likewise each row has the same number of columns (even if a given element in the table is missing or "NA").

Let's make a data frame using the `data.frame()` command. You'll notice this time the `dim()` command does work.

```{r}
#using data.frame()
a1to5df <- data.frame(a1,a2,a3,a4,a5)
a1to5df
class(a1to5df)
str(a1to5df)
dim(a1to5df)
```

You'll notice that something new showed up - a "factor" object type (for the 2nd and 4th columns (a2 and a4) of `a1to5df`). We can avoid this by setting `stringsAsFactors` to `FALSE` when creating the data frame.

```{r}
a1to5dfnf <- data.frame(a1,a2,a3,a4,a5,
                        stringsAsFactors = FALSE)
a1to5dfnf
class(a1to5dfnf)
str(a1to5dfnf)
dim(a1to5dfnf)
```

# EXERCISE 1

Create a new data frame object called `df1` using the `data.frame()` command. Combine the object `y` with the built in constant for `month.name` and `month.abb`.

Create the data frame again and call it `df2` using the same 3 objects (`y`, `month.name` and `month.abb`) and set `stringsAsFactors` to FALSE.

# ANSWER to EXERCISE 1

```{r}
df1 <- data.frame(y, month.name, month.abb)
df1
str(df1)

df2 <- data.frame(y, month.name, month.abb,
                  stringsAsFactors = FALSE)
df2
str(df2)
```

## Ways to view or review data in objects

One way to view a data object is to use the `fix()` command. Running the following code will open a basic editor window (notepad) to view the object `z` and then the object `alist`.

```{r eval = FALSE}
fix(z)
fix(alist1)
```

You've already seen that you can simply type the name of the object to view it in its entirety within the console. However, for larger datasets this can rapidly fill up your console and will significantly slow R down and may even cause R to crash or lock up. So, one way is to look aat only a small portion of the dataset such as the 1st few or the last few rows. We can do that using either the `head()` or `tail()` commands.

Let's look at the `head()` and `tail()` of the `df1` object you just created in EXERCISE 1 above.

```{r}
head(df1)
tail(df1)
```

Another way to look at a given object is to simply use the data viewer. You can either click on the little table icon next to the object in the "Global Environment" window (top right) - OR you can run the `View()` command. You'll notice this command begins with a capital `V` and not the lowercase `v`. R is CaSe sensitive so always check. Try typing in `view(df1)` and see what happens.

```{r eval = FALSE}
View(df1)
```

```{r}
view(df1)
```

## Let's make a plot

So far we have created a numeric vector of 21 numbers sequence from 0 to 10 in units of 0.5. This was object `z`. We also created `sinz` which was the sine of these numbers. Let's make a plot of these together. 

```{r}
plot(z,sinz)
```

Let's add some more details to the plot. Look at the help pages for the plot function `help(plot)` to see what options are available. We'll use the code below to add a label to the x-axis, y-axis, plus a title and a subtitle.

```{r}
plot(z, sinz, 
     xlab='Z = Sequence 0 to 10 by 0.5', 
     ylab='Sin(Z)', 
     main='Main title', 
     sub='example subtitle')
```

We can also add a line and modify the points or markers in the plot. When you review the `help(plot)` help pages towards the bottom there is a "See Also" section which links to the functions `lines()` and `points()`. We'll use these 2 functions to add a colorful line and modify the points on our plot.

```{r}
# add a BLUE line using lines()
lines(z,sinz,col='blue')

# customize the points using points()
# plotting character pch 23 is a filled diamond
# col defines the color
# bg defines the filled or background color
points(z,sinz,pch=23,col='red',bg='black')
```

Let's compile all of the code together into a single code block to make our plot.

```{r}
# select code above, right click and "run selection"
# or highlight code and click CTRL-R
# specifically run the following code all together
# the spaces and line returns added for clarity
# Note: RStudio helps with good formatting practices

plot(z, sinz,
     xlab = 'Z = Sequence 0 to 10 by 0.5',
     ylab = 'Sin(Z)',main='Main title',
     sub = 'example subtitle')
lines(z, sinz, col = 'blue')
points(z, sinz, pch = 23, col = 'red', bg = 'black')

```

## The graphics "Plots" window

In graphics "Plots" Window click on "Zoom". This will open the plot into a separate window. Once this window is open, you can right click and either copy the figure or save it. Within the "Plots" window itself you can also click on "Export". From here you can "Save As Image", "Save as PDF" or "Copy to Clipboard." The "Save as Image" gives you lots of options for saving the figure including: PNG, JPEG, TIFF, BMP, Metafile, SVG or EPS and you can change the figure size. _[Note: many journals request pastscript - EPS is the encapsulated postscript format.]_ When you "Copy to Clipboard" you also get options for copying the figure as either a Bitmap (pixel-by-pixel does not scale well) or a Metafile (which is a vectorized format and will scale well).

## Other ways to get graphics out and saved

There are command line ways to save graphical output. You can use any of the "Devices" that R supports. See `help()` on `Devices`. For example, suppose we wanted to save our figure above out as a PDF. We would use the `pdf()` device to do this. Here is the code. You'll notice I ran `dev.off()` at the end to be sure the device is turned back off. You MUST DO THIS for the final file to be created and your figure saved.

```{r}
pdf(file = "plot1.pdf")
plot(z, sinz,
     xlab = 'Z = Sequence 0 to 10 by 0.5',
     ylab = 'Sin(Z)',main='Main title',
     sub = 'example subtitle')
lines(z, sinz, col = 'blue')
points(z, sinz, pch = 23, col = 'red', bg = 'black')
dev.off()
```

# EXERCISE 2

Look up which "device" will create and save the plot as a JPEG. Use the commands above as your guide and create and save the figure as a JPEG formatted file.

Create a second JPEG where the width is 750 pixels and the height is 500 pixels and set the background color to yellow and the quality to 50.

# ANSWER KEY for EXERCISE 2

```{r}
jpeg(file = "plot1.jpg")
plot(z, sinz,
     xlab = 'Z = Sequence 0 to 10 by 0.5',
     ylab = 'Sin(Z)',main='Main title',
     sub = 'example subtitle')
lines(z, sinz, col = 'blue')
points(z, sinz, pch = 23, col = 'red', bg = 'black')
dev.off()

jpeg(file = "plot1yellow.jpg", 
     width=750, height=500,
     bg = "yellow",
     quality = 50)
plot(z, sinz,
     xlab = 'Z = Sequence 0 to 10 by 0.5',
     ylab = 'Sin(Z)',main='Main title',
     sub = 'example subtitle')
lines(z, sinz, col = 'blue')
points(z, sinz, pch = 23, col = 'red', bg = 'black')
dev.off()
```

## Adding packages

Just like SAS and SPSS have a base software to which you can add additional packages and "add-ons" to add additional functionality and features to your software, R comes with a base set of functions to which you can add literally thousands of packages and hundreds of thousands of additional functions and features.

As of March 8, 2016, there are 8054 packages available from [CRAN](https://cran.r-project.org/web/packages/). Many other packages are also available on Github. Hadley Wickham's "R Packages" book has some excellent information on writing and publishing your own packages. See [http://r-pkgs.had.co.nz/git.html](http://r-pkgs.had.co.nz/git.html). 

Still even more packages are available from [Bioconductor](https://www.bioconductor.org/). Currently, they list over 1104 pacakges available from their repositories.

### Let's install `ggplot2` package

`ggplot2` is another excellent graphics package by Hadley Wickham. The main CRAN site for this package is at [https://cran.r-project.org/web/packages/ggplot2/index.html](https://cran.r-project.org/web/packages/ggplot2/index.html). Hadley also has an entire website devoted to this package at [http://ggplot2.org/](http://ggplot2.org/) and he maintains the Github repository for package development at [https://github.com/hadley/ggplot2](https://github.com/hadley/ggplot2).

In general I recommend installing the most current version hosted at CRAN. We can do this using the menus "Tools"/"Install Packages". This opens a window where you can start typing in the package you want. RStudio will begin providing a list of packages that match that name and you can then pick the one you want and click "install." Take note of where on your hard drive the package is installed.

This process runs the following command which will also install the `ggplot2` package. 

```{r eval=FALSE}
install.packages("ggplot2")
```

Before we can use the added functions in this new package, we must "load" the package into our R session. For this we use the `library()` command. You'll notice that we used `"` quotes when we typed in the name of the package in `install.packages()` but we leave these off when we call the `library()` command. _Yes, it is a nuiance of R..._

```{r eval=FALSE}
library(ggplot2)
```

Let's look at the help window for this new package. Run the following code. 

```{r eval=FALSE}
help(package = "ggplot2")
```

Now that we've got `ggplot2` loaded we can use these graphic options and functions to make our plot. Let's try the `qplot` function first. Look at the `help()` pages on `qplot()`. 

We put in `z` and `sinz` like we did last time, but now we can add in the points and lines as "geometrical objects or `geom`s. We can also add a label for the x-axis and y-axis using the `xlab` and `ylab` options and a title using the `main` option. We do not have a subtitle option here.

```{r}
qplot(z, sinz,
      geom = c("point", "line"),
      xlab = 'Z = Sequence 0 to 10 by 0.5',
      ylab = 'Sin(Z)',
      main = 'Main title')
title(main = 'a new main title',
      sub = 'a subtitle added')
```




